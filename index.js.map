{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function getImagesByQuery(query, page) {\n  let per_page = 15;\n\n  const API_KEY = '52541066-61f39c635ccb9e2a2a197a680';\n\n  const res = await axios('https://pixabay.com/api/', {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page,\n      per_page,\n    },\n  });\n  // console.log(res.data);\n  return res.data;\n}\n","// Описаний у документації\nimport SimpleLightbox from 'simplelightbox';\n// Додатковий імпорт стилів\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet gallery;\nconst loader = document.querySelector('.loader');\nconst btn = document.querySelector('.button');\n\nconst list = document.querySelector('.gallery');\n\nexport function createGallery(images) {\n  // console.log(images);\n  // const list = document.querySelector('.gallery');\n\n  const itemGallery = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item\">\n  <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <img\n      class=\"gallery-image\"\n      src=\"${webformatURL}\"\n      alt=\"${tags}\"\n    />\n  </a>\n  <ul class = \"discription\">\n  <li class = \"item\"><h2 class = \"title\">Likes</h2>${likes}</li>\n  <li class = \"item\"><h2 class = \"title\">Views</h2>${views}</li>\n  <li class = \"item\"><h2 class = \"title\">Comments</h2>${comments}</li>\n  <li class = \"item\"><h2 class = \"title\">Downloads</h2>${downloads}</li>\n  </ul>\n</li>`;\n      }\n    )\n    .join('');\n\n  //   list.insertAdjacentHTML('beforeend', itemGallery);\n  list.insertAdjacentHTML('beforeend', itemGallery);\n\n  if (!gallery) {\n    gallery = new SimpleLightbox('.gallery a', {\n      captions: true,\n      captionsData: 'alt',\n      captionDelay: 250,\n      captionPosition: 'bottom',\n    });\n\n    gallery.on('show.simplelightbox', function (event) {\n      console.log(`Open: ${event.target.querySelector('img').alt}`);\n    });\n  } else {\n    // console.log('mmm');\n    gallery.refresh();\n  }\n}\n\nexport function clearGallery() {\n  // const list = document.querySelector('.gallery');\n  list.innerHTML = '';\n}\n\nexport function showLoader() {\n  // const loader = document.querySelector('.loader');\n\n  loader.classList.remove('hidden');\n}\n\nexport function hideLoader() {\n  // const loader = document.querySelector('.loader');\n  loader.classList.add('hidden');\n}\n\nexport function showLoadMoreButton() {\n  // const loader = document.querySelector('.loader');\n\n  btn.classList.remove('hidden');\n}\n\nexport function hideLoadMoreButton() {\n  // const loader = document.querySelector('.loader');\n  btn.classList.add('hidden');\n}\n","import { getImagesByQuery } from './js/pixabay-api';\n\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n} from './js/render-functions';\n\n// Описаний у документації\nimport iziToast from 'izitoast';\n// Додатковий імпорт стилів\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('.form');\nconst input = document.querySelector('input');\nconst btn = document.querySelector('.button');\n\nform.addEventListener('submit', formSubmit);\nlet q;\nlet page = 1;\nlet totalHits = 0;\nlet per_page = 15;\n\nasync function formSubmit(event) {\n  event.preventDefault();\n  page = 1;\n  showLoader();\n  q = event.target.elements['search-text'].value.toLowerCase().trim();\n\n  if (q === '') {\n    hideLoader();\n    hideLoadMoreButton();\n    iziToast.warning({\n      message: 'Please fill in all required fields',\n    });\n    return;\n  }\n\n  // console.log(q);\n  try {\n    const resAwait = await getImagesByQuery(q, page);\n    totalHits = resAwait.totalHits;\n    // console.log(totalHits);\n    hideLoader();\n    if (resAwait.hits.length === 0) {\n      clearGallery();\n      hideLoadMoreButton();\n      input.value = '';\n      iziToast.error({\n        // title: 'X',\n        message: `Sorry, there are no images matching your search query. Please try again!`,\n        // color: 'red',\n      });\n      return;\n    } else {\n      clearGallery();\n      createGallery(resAwait.hits);\n      page += 1;\n      showLoadMoreButton();\n      input.value = '';\n    }\n\n    if (Math.ceil(totalHits / per_page) < page) {\n      hideLoader();\n      hideLoadMoreButton();\n      iziToast.error({\n        message: `No more pictures`,\n      });\n    }\n  } catch (error) {\n    hideLoadMoreButton();\n    hideLoader();\n    clearGallery();\n    iziToast.error({\n      // title: 'X',\n      message: `Sorry, ${error}!`,\n      // color: 'red',\n    });\n  }\n}\n\nbtn.addEventListener('click', clickMoreItem);\n\nasync function clickMoreItem() {\n  showLoader();\n  if (Math.ceil(totalHits / per_page) < page) {\n    hideLoader();\n    hideLoadMoreButton();\n    iziToast.error({\n      message: `We are sorry, but you have reached the end of search results`,\n    });\n    return;\n  }\n  try {\n    const resAwait = await getImagesByQuery(q, page);\n    hideLoader();\n    if (resAwait.hits.length === 0) {\n      hideLoadMoreButton();\n      clearGallery();\n      iziToast.error({\n        // title: 'X',\n        message: `Sorry, there are no images matching your search query. Please try again!`,\n        // color: 'red',\n      });\n    } else {\n      showLoadMoreButton();\n      createGallery(resAwait.hits);\n      const { height } = document\n        .querySelector('.gallery')\n        .firstElementChild.getBoundingClientRect();\n\n      window.scrollBy({\n        top: height * 2,\n        behavior: 'smooth',\n      });\n      page += 1;\n    }\n  } catch (error) {\n    hideLoader();\n    hideLoadMoreButton();\n    clearGallery();\n    iziToast.error({\n      // title: 'X',\n      message: `Sorry, ${error}!`,\n      // color: 'red',\n    });\n  }\n}\n\n// getImagesByQuery(q, page)\n//   .then(data => {\n//     // console.log(data);\n//     if (data.length === 0) {\n//       hideLoader();\n//       clearGallery();\n//       input.value = '';\n//       iziToast.error({\n//         // title: 'X',\n//         message: `Sorry, there are no images matching your search query. Please try again!`,\n//         // color: 'red',\n//       });\n//     } else {\n//       hideLoader();\n//       createGallery(data);\n//       input.value = '';\n//     }\n//     // console.log(res.data);\n//   })\n//       .catch(error => {\n//         hideLoader();\n//         clearGallery();\n//         iziToast.error({\n//           // title: 'X',\n//           message: `Sorry, ${error}!`,\n//           // color: 'red',\n//         });\n//       });\n//   }\n// }\n"],"names":["getImagesByQuery","query","page","axios","gallery","loader","btn","list","createGallery","images","itemGallery","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","event","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","input","formSubmit","q","totalHits","per_page","iziToast","resAwait","error","clickMoreItem","height"],"mappings":"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"}