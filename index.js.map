{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function getImagesByQuery(query, page) {\n  let per_page = 15;\n\n  const API_KEY = '52541066-61f39c635ccb9e2a2a197a680';\n\n  const res = await axios('https://pixabay.com/api/', {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page,\n      per_page,\n    },\n  });\n  // console.log(res.data);\n  return res.data;\n}\n","// Описаний у документації\nimport SimpleLightbox from 'simplelightbox';\n// Додатковий імпорт стилів\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet gallery;\nconst loader = document.querySelector('.loader');\nconst btn = document.querySelector('.button');\nconst input = document.querySelector('input');\nconst list = document.querySelector('.gallery');\n\nexport function clearInput() {\n  input.value = '';\n}\n\nexport function createGallery(images) {\n  // console.log(images);\n  // const list = document.querySelector('.gallery');\n\n  const itemGallery = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item\">\n  <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <img\n      class=\"gallery-image\"\n      src=\"${webformatURL}\"\n      alt=\"${tags}\"\n    />\n  </a>\n  <ul class = \"discription\">\n  <li class = \"item\"><h2 class = \"title\">Likes</h2>${likes}</li>\n  <li class = \"item\"><h2 class = \"title\">Views</h2>${views}</li>\n  <li class = \"item\"><h2 class = \"title\">Comments</h2>${comments}</li>\n  <li class = \"item\"><h2 class = \"title\">Downloads</h2>${downloads}</li>\n  </ul>\n</li>`;\n      }\n    )\n    .join('');\n\n  //   list.insertAdjacentHTML('beforeend', itemGallery);\n  list.insertAdjacentHTML('beforeend', itemGallery);\n\n  if (!gallery) {\n    gallery = new SimpleLightbox('.gallery a', {\n      captions: true,\n      captionsData: 'alt',\n      captionDelay: 250,\n      captionPosition: 'bottom',\n    });\n\n    gallery.on('show.simplelightbox', function (event) {\n      console.log(`Open: ${event.target.querySelector('img').alt}`);\n    });\n  } else {\n    // console.log('mmm');\n    gallery.refresh();\n  }\n}\n\nexport function clearGallery() {\n  // const list = document.querySelector('.gallery');\n  list.innerHTML = '';\n}\n\nexport function showLoader() {\n  // const loader = document.querySelector('.loader');\n\n  loader.classList.remove('hidden');\n}\n\nexport function hideLoader() {\n  // const loader = document.querySelector('.loader');\n  loader.classList.add('hidden');\n}\n\nexport function showLoadMoreButton() {\n  // const loader = document.querySelector('.loader');\n\n  btn.classList.remove('hidden');\n}\n\nexport function hideLoadMoreButton() {\n  // const loader = document.querySelector('.loader');\n  btn.classList.add('hidden');\n}\n","import { getImagesByQuery } from './js/pixabay-api';\n\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  clearInput,\n} from './js/render-functions';\n\n// Описаний у документації\nimport iziToast from 'izitoast';\n// Додатковий імпорт стилів\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('.form');\nconst btn = document.querySelector('.button');\n\nform.addEventListener('submit', formSubmit);\nlet q;\nlet page = 1;\nlet totalHits = 0;\nlet per_page = 15;\n\nasync function formSubmit(event) {\n  event.preventDefault();\n  page = 1;\n  showLoader();\n  q = event.target.elements['search-text'].value.toLowerCase().trim();\n\n  if (q === '') {\n    hideLoader();\n    hideLoadMoreButton();\n    iziToast.warning({\n      message: 'Please fill in all required fields',\n    });\n    return;\n  }\n  clearGallery();\n  // console.log(q);\n  try {\n    const resAwait = await getImagesByQuery(q, page);\n    totalHits = resAwait.totalHits;\n    // console.log(totalHits);\n    hideLoader();\n    if (resAwait.hits.length === 0) {\n      hideLoadMoreButton();\n      //   input.value = '';\n      iziToast.error({\n        // title: 'X',\n        message: `Sorry, there are no images matching your search query. Please try again!`,\n        // color: 'red',\n      });\n      return;\n    } else {\n      createGallery(resAwait.hits);\n      clearInput();\n    }\n\n    if (Math.ceil(totalHits / per_page) <= page) {\n      hideLoadMoreButton();\n      iziToast.error({\n        message: `No more pictures`,\n      });\n    } else {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    hideLoadMoreButton();\n    hideLoader();\n    clearGallery();\n    iziToast.error({\n      // title: 'X',\n      message: `Sorry, ${error}!`,\n      // color: 'red',\n    });\n  }\n}\n\nbtn.addEventListener('click', clickMoreItem);\n\nasync function clickMoreItem() {\n  showLoader();\n  page++;\n\n  try {\n    const resAwait = await getImagesByQuery(q, page);\n    hideLoader();\n    if (resAwait.hits.length === 0) {\n      hideLoadMoreButton();\n      clearGallery();\n      iziToast.error({\n        // title: 'X',\n        message: `Sorry, there are no images matching your search query. Please try again!`,\n        // color: 'red',\n      });\n    } else {\n      createGallery(resAwait.hits);\n      const card = document.querySelector('.gallery-item');\n      if (card) {\n        const { height } = card.getBoundingClientRect();\n\n        window.scrollBy({\n          top: height * 2,\n          behavior: 'smooth',\n        });\n      }\n    }\n\n    if (Math.ceil(totalHits / per_page) <= page) {\n      hideLoadMoreButton();\n      iziToast.error({\n        message: `We are sorry, but you have reached the end of search results`,\n      });\n      return;\n    } else {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    hideLoader();\n    hideLoadMoreButton();\n    clearGallery();\n    iziToast.error({\n      // title: 'X',\n      message: `Sorry, ${error}!`,\n      // color: 'red',\n    });\n  }\n}\n\n// getImagesByQuery(q, page)\n//   .then(data => {\n//     // console.log(data);\n//     if (data.length === 0) {\n//       hideLoader();\n//       clearGallery();\n//       input.value = '';\n//       iziToast.error({\n//         // title: 'X',\n//         message: `Sorry, there are no images matching your search query. Please try again!`,\n//         // color: 'red',\n//       });\n//     } else {\n//       hideLoader();\n//       createGallery(data);\n//       input.value = '';\n//     }\n//     // console.log(res.data);\n//   })\n//       .catch(error => {\n//         hideLoader();\n//         clearGallery();\n//         iziToast.error({\n//           // title: 'X',\n//           message: `Sorry, ${error}!`,\n//           // color: 'red',\n//         });\n//       });\n//   }\n// }\n"],"names":["getImagesByQuery","query","page","axios","gallery","loader","btn","input","list","clearInput","createGallery","images","itemGallery","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","event","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","formSubmit","q","totalHits","per_page","iziToast","resAwait","error","clickMoreItem","card","height"],"mappings":"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"}